<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    {% load static %}
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="icon" href="{% static 'logo.ico' %}">
    <title>模型调试</title>
    <!-- 引入样式 -->
    <link rel="stylesheet" href="{% static 'import/css/index.css' %}">
    <link rel="stylesheet" href="{% static 'main_css/main.css' %}">
    <!-- 引入组件库 -->
    <script src="{% static 'import/vue.js' %}"></script>
    <script src="{% static 'import/element_index.js' %}"></script>
   
    <script src="{% static 'import/dat.gui.min.js' %}"></script>
    <script src="{% static 'import/SceneUtils.js' %}"></script>
    <script src="{% static 'import/jquery-3.4.1.min.js' %}"></script>
    <script src="{% static 'import/vue-resource.min.js' %}"></script>
    
</head>
<body>
    <div>
        <!--加载动画的div-->
        <div id="app">
            <div id="full_page" >
                <div id="control-inner">
                    <div style="width: 195px;">
                        <h3>新建文件夹</h3>
                        <el-input v-model="folder_name" placeholder="请输入内容"></el-input>
                        <br><br>
                        <el-button type="primary" v-on:click="create_folder">新建文件夹</el-button>
                        <br><br>
                    </div>
                    
                    <div style="width: 400px;">
                    <h3>上传模型</h3>
                    <template>
                        <el-select v-model="folder_selected" placeholder="选择文件夹">
                          <el-option
                            v-for="item in folders"
                            :key="item.value"
                            :label="item.label"
                            :value="item.value">
                          </el-option>
                        </el-select>
                    </template>
                    <br><br>
                    <el-upload
                    class="upload-demo"
                    action="https://jsonplaceholder.typicode.com/posts/"
                    :on-preview="handlePreview"
                    :on-remove="handleRemove"
                    :before-remove="beforeRemove"
                    multiple
                    :limit="3"
                    :on-exceed="handleExceed"
                    :file-list="fileList">
                    <el-button size="small" type="primary">点击上传</el-button>
                    <div slot="tip" class="el-upload__tip">只能上传jpg/png文件，且不超过500kb</div>
                    </el-upload>
                    </div>
                </div>
            </div>
        </div>
        </div>
            
        </div>
    </div>
    <script>
        let Main = {
            data() {
                return {
                    folder_name:'',
                    folders:[],
                    folder_selected:'',
                    fileList: [{name: 'food.jpeg', url: 'https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100'}, {name: 'food2.jpeg', url: 'https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100'}],                   
                }                    
                },
                mounted:function(){
                this.get_folders();

            },
            methods: {
                create_folder(){
                    if(this.folder_name==''){
                        alert('文件夹名称不能为空');
                        return false;
                    }
                    this.$http.post(
                    '/vmm/create_folder/',
                    {
                        folder_name:this.folder_name
                    },
                    { 
                        emulateJSON: true 
                    }
                    ).then(function (res) {
                        console.log(res);
                        // alert(res.body)
                        this. folders=[];
                        this.get_folders();

                    });
                },
                get_folders(){
                    this.$http.get(
                    '/vmm/get_folders/'
                    ).then(function (res) {
                        res.body.folders.forEach(folder => {
                            this.folders.push({value: folder.id,label: folder.folder_name});
                        })
                    });
                },
                handleRemove(file, fileList) {
                    console.log(file, fileList);
                },
                handlePreview(file) {
                    console.log(file);
                },
                handleExceed(files, fileList) {
                    this.$message.warning(`当前限制选择 3 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`);
                },
                beforeRemove(file, fileList) {
                    return this.$confirm(`确定移除 ${ file.name }？`);
                }
            }
        }
        var Ctor = Vue.extend(Main)
        new Ctor().$mount('#app')
    </script>
</body>
</html>